<<<<<<< HEAD
{"version":3,"file":"canvas.js","sources":["../lib/api.js","../lib/controller/canno.js","../lib/controller/bullet.js","../lib/utils.js","../lib/instance/bullet.js","../lib/instance/canno.js","../lib/instance/index.js","../lib/index.js"],"sourcesContent":["import bottomJson from '../json/bottom.json'\r\nimport bulletJson from '../json/bullet.json'\r\nimport webJson from '../json/web.json'\r\nconst res = [bottomJson, bulletJson, webJson]\r\nexport const initRequestData = ({ ctx: _ctx, W, H, handlesInfo }) => {\r\n  let count = 0\r\n  let total = res.reduce((p, { frames }) => p + Object.keys(frames).length, 0)\r\n  return new Promise((resolve) => {\r\n    const result = res.reduce((p, c) => {\r\n      const { frames } = c\r\n      Object.keys(frames).forEach(key => {\r\n        const { frame: { x, y } } = frames[key]\r\n        const img = new Image()\r\n        img.src = `../01.捕鱼达人/images/${key}`\r\n        img.onload = function () {\r\n          count++;\r\n          p[key] = {\r\n            x,\r\n            y,\r\n            w: img.width,\r\n            h: img.height,\r\n            img,\r\n            ctx: _ctx,\r\n            W,\r\n            H,\r\n            handlesInfo\r\n          }\r\n          if (count === total) {\r\n            loadResolve()\r\n          }\r\n        }\r\n      })\r\n      return p\r\n    }, {})\r\n\r\n    function loadResolve () {\r\n      resolve(result)\r\n    }\r\n  })\r\n}\r\n\r\n","import { ctx } from '../index'\r\nclass Cannocontroller {\r\n  constructor() {\r\n    // 底座名称\r\n    this.baseName = 'bottom-bar.png'\r\n    // 炮台名称前缀\r\n    this.cannoNamePrefix = 'cannon'\r\n    // 炮台名称后缀\r\n    this.cannoNameEndFix = 'png'\r\n    // 图片详情\r\n    this.imgInfo = {}\r\n    // 炮台动画帧\r\n    this.frame = 0\r\n  }\r\n  // 安装炮台底座\r\n  installCannoBase = (data, options) => {\r\n    const info = data[this.baseName]\r\n    this.drawCannoBase(info)\r\n    this.imgInfo[this.baseName] = info\r\n  }\r\n  // 绘制底座\r\n  drawCannoBase = (info) => {\r\n    const { w, h, img, W, H } = info\r\n    // 绘制到底部中心\r\n    const x = (W - w) / 2, y = H - h + 2\r\n    ctx.drawImage(img, x, y, w, h)\r\n  }\r\n\r\n  // 安装炮台\r\n  installCanno = (data, type) => {\r\n    const key = `${this.cannoNamePrefix}${type}.${this.cannoNameEndFix}`\r\n    const info = data[key]\r\n    this.drawCanno(info, this.frame)\r\n    this.imgInfo[key] = info\r\n  }\r\n  // 绘制炮台\r\n  drawCanno = (info, frame) => {\r\n    /*\r\n        计算弧度:\r\n          1. 我们知道炮台中心点位置 a\r\n          2. 我们知道鼠标移动位置 b\r\n          3. 炮台是垂直于canvas的\r\n          4. 弧度 === tan(对边 / 临边)\r\n    */\r\n    const { w, h, img, W, H, handlesInfo: { mousemove } } = info\r\n    const canvas = ctx.canvas\r\n    const offsetLeft = canvas.offsetLeft\r\n    const offsetTop = canvas.offsetTop\r\n    const x = (W - w) / 2 + 43, y = H - h / 4 + 20\r\n    const a = x + offsetLeft - mousemove.x + w / 2\r\n    const b = y + offsetTop - mousemove.y\r\n    const arc = Math.atan2(b, a) - Math.PI / 2\r\n    ctx.save()\r\n    ctx.translate(x + w / 2, y + h / 10)\r\n    ctx.rotate(arc)\r\n    ctx.drawImage(\r\n      img,\r\n      0, h / 5 * frame, w, h / 5,\r\n      -w / 2, -(h / 10), w, h / 5\r\n    )\r\n    ctx.restore()\r\n  }\r\n}\r\nexport default new Cannocontroller","import { ctx } from '../index'\r\nclass Bulltecontroller {\r\n  constructor() {\r\n    this.baseName = 'bullet'\r\n    this.endType = 'png'\r\n  }\r\n  // 安装炮弹\r\n  installBullte (data, type) {\r\n    const key = `${this.baseName}${type}.${this.endType}`\r\n    const info = data[key]\r\n    this.drawBullte(info)\r\n  }\r\n  // 绘制炮弹\r\n  drawBullte (info) {\r\n    const { w, h, img, W, H } = info\r\n    const x = (W - w) / 2 + 40, y = H - h\r\n    // 要将炮弹绘制到炮台上\r\n    ctx.drawImage(img, x, y, w, h)\r\n  }\r\n\r\n}\r\nexport default new Bulltecontroller","/**\r\n * 工具函数\r\n */\r\nexport const createInstance = (instance, options = {}) => {\r\n  return new instance(options)\r\n}\r\nexport const deg2Arc = (deg) => {\r\n  return deg * (Math.PI / 180)\r\n}\r\nexport const arc2Deg = (arc) => {\r\n  return arc * (180 / Math.PI)\r\n}\r\n\r\nexport function registerListener (eventName, el) {\r\n  let handles = {}\r\n  handles[eventName] = {}\r\n  el.addEventListener('mousemove', (e) => {\r\n    handles[eventName].x = e.clientX\r\n    handles[eventName].y = e.clientY\r\n  })\r\n  return handles\r\n}\r\n","import { bulletInstance } from '../controller/index'\r\n// 炮弹类\r\nclass Bullet {\r\n  constructor(data, options = {}) {\r\n    this.data = data\r\n    this.type = options.type || 1\r\n    // 装载炮弹的集合\r\n    this.bullets = []\r\n  }\r\n  // 安装炮弹\r\n  installBullte = () => {\r\n    bulletInstance.installBullte(this.data, this.type, this.bullets)\r\n  }\r\n  // 添加炮弹\r\n  addBullte (bullte) {\r\n    this.bullets.push(bullte)\r\n  }\r\n  // 移除炮弹\r\n  removeBullte (bullte) {\r\n\r\n  }\r\n}\r\nexport default Bullet","import { cannoInstance } from '../controller/index'\r\nimport { createInstance } from '../utils'\r\nimport Bullet from './bullet'\r\nimport { ctx } from '../index'\r\n\r\n// 炮台类\r\nclass Canno {\r\n  constructor(data, options = {}) {\r\n    this.data = data\r\n    // 炮台有分颜色 1-7\r\n    this.type = options.type || 1\r\n    // 安装\r\n    this.install()\r\n  }\r\n  // 安装炮台底座\r\n  installCannoBase = () => {\r\n    cannoInstance.installCannoBase(this.data, this.type)\r\n  }\r\n  // 安装炮台\r\n  installCanno = () => {\r\n    cannoInstance.installCanno(this.data, this.type)\r\n  }\r\n  // 安装炮弹\r\n  installBullte = () => {\r\n    const bulletInstance = this.bulletInstance\r\n      ? this.bulletInstance\r\n      : createInstance(Bullet, {\r\n        data: this.data,\r\n        type: this.type\r\n      })\r\n    this.bulletInstance = bulletInstance\r\n    bulletInstance.installBullte() // {type:?,arc:?,speed:?,x:?,y:?}\r\n  }\r\n  install = () => {\r\n    window.requestAnimationFrame(this.draw)\r\n  }\r\n  draw = () => {\r\n    const canvas = ctx.canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n    this.installCannoBase()\r\n    this.installCanno()\r\n    window.requestAnimationFrame(this.install)\r\n  }\r\n}\r\nexport default Canno","import Canno from './canno'\r\nimport Bullet from './bullet'\r\nexport function initAllInstance () {\r\n  return {\r\n    Canno,\r\n    Bullet\r\n  }\r\n}","/**\r\n * 入口\r\n */\r\nimport { initRequestData } from './api'\r\nimport { initAllInstance } from './instance/index'\r\nimport { createInstance, registerListener } from './utils'\r\nexport let ctx\r\nasync function init () {\r\n  // 初始化canvas\r\n  const { ctx: _ctx, W, H, handlesInfo } = initCanvas('fishing')\r\n  // 初始化数据\r\n  const data = await initRequestData({ ctx: _ctx, W, H, handlesInfo })\r\n  ctx = _ctx\r\n  // 初始化类\r\n  const { Canno } = initAllInstance()\r\n  // 创建炮台实例\r\n  createInstance(Canno, data)\r\n}\r\ninit()\r\n\r\nfunction initCanvas (id) {\r\n  const canvas = document.getElementById(id)\r\n  const ctx = canvas.getContext('2d')\r\n  // 注册事件\r\n  const handlesInfo = registerListener('mousemove', canvas)\r\n  return {\r\n    ctx,\r\n    W: canvas.width,\r\n    H: canvas.height,\r\n    handlesInfo\r\n  }\r\n}\r\n\r\n\r\n"],"names":["res","bottomJson","bulletJson","webJson","initRequestData","ctx","_ctx","W","H","handlesInfo","count","total","reduce","p","frames","Object","keys","length","Promise","resolve","result","c","forEach","key","frame","x","y","img","Image","src","onload","w","width","h","height","loadResolve","Cannocontroller","constructor","baseName","cannoNamePrefix","cannoNameEndFix","imgInfo","installCannoBase","data","options","info","drawCannoBase","drawImage","installCanno","type","drawCanno","mousemove","canvas","offsetLeft","offsetTop","a","b","arc","Math","atan2","PI","save","translate","rotate","restore","Bulltecontroller","endType","installBullte","drawBullte","createInstance","instance","registerListener","eventName","el","handles","addEventListener","e","clientX","clientY","Bullet","bullets","bulletInstance","addBullte","bullte","push","removeBullte","Canno","install","cannoInstance","window","requestAnimationFrame","draw","clearRect","initAllInstance","init","initCanvas","id","document","getElementById","getContext"],"mappings":"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"}
=======
{"version":3,"file":"canvas.js","sources":["../lib/api.js","../lib/controller/bullet.js","../lib/controller/canno.js","../lib/utils.js","../lib/instance/canno.js","../lib/instance/index.js","../lib/index.js"],"sourcesContent":["import bottomJson from '../json/bottom.json'\r\nimport bulletJson from '../json/bullet.json'\r\nimport webJson from '../json/web.json'\r\nconst res = [bottomJson, bulletJson, webJson]\r\nexport const initRequestData = ({ ctx: _ctx, W, H, handlesInfo }) => {\r\n  let count = 0\r\n  let total = res.reduce((p, { frames }) => p + Object.keys(frames).length, 0)\r\n  return new Promise((resolve) => {\r\n    const result = res.reduce((p, c) => {\r\n      const { frames } = c\r\n      Object.keys(frames).forEach(key => {\r\n        const { frame: { x, y } } = frames[key]\r\n        const img = new Image()\r\n        img.src = `../01.捕鱼达人/images/${key}`\r\n        img.onload = function () {\r\n          count++;\r\n          p[key] = {\r\n            x,\r\n            y,\r\n            w: img.width,\r\n            h: img.height,\r\n            img,\r\n            ctx: _ctx,\r\n            W,\r\n            H,\r\n            handlesInfo\r\n          }\r\n          if (count === total) {\r\n            loadResolve()\r\n          }\r\n        }\r\n      })\r\n      return p\r\n    }, {})\r\n\r\n    function loadResolve () {\r\n      resolve(result)\r\n    }\r\n  })\r\n}\r\n\r\n","import { ctx } from '../index'\r\nclass Bulltecontroller {\r\n  constructor() {\r\n    this.baseName = 'bullet'\r\n    this.endType = 'png'\r\n    this.speed = 5\r\n  }\r\n  // 安装炮弹\r\n  installBullte = (data, type, bulltes) => {\r\n    const key = `${this.baseName}${type}.${this.endType}`\r\n    const info = data[key]\r\n    bulltes.forEach(bullte => {\r\n      this.drawBullte(info, bullte)\r\n    })\r\n  }\r\n  // 绘制炮弹\r\n  drawBullte = (info, bullte) => {\r\n    const { w, h, img, W, H } = info\r\n    const { x, y, type, arc } = bullte\r\n    ctx.save()\r\n    ctx.translate(x, y)\r\n    ctx.rotate(arc)\r\n    // 要将炮弹绘制到炮台上\r\n    ctx.drawImage(img, -w / 2, -h / 2, w, h)\r\n    ctx.restore()\r\n  }\r\n  // 发射炮弹\r\n  launchBullte (bulltes) {\r\n    bulltes.forEach(bullet => {\r\n      // 已知角度，自定义速度(斜边)，求对边和临边\r\n      const x = Math.sin(bullet.arc) * this.speed\r\n      const y = Math.cos(bullet.arc) * this.speed\r\n      bullet.x += x\r\n      bullet.y -= y\r\n    })\r\n  }\r\n\r\n}\r\nexport default new Bulltecontroller","import { ctx } from '../index'\r\nimport Bullte from './bullet'\r\nimport bullet from './bullet'\r\nclass Cannocontroller {\r\n  constructor() {\r\n    // 底座名称\r\n    this.baseName = 'bottom-bar.png'\r\n    // 炮台名称前缀\r\n    this.cannoNamePrefix = 'cannon'\r\n    // 炮台名称后缀\r\n    this.cannoNameEndFix = 'png'\r\n    // 图片详情\r\n    this.imgInfo = {}\r\n    // \r\n    this.frame = 0\r\n    this.bulltes = [] // {type:?,x:?,y:?,arc:?}\r\n    this.positionInfo = {}\r\n  }\r\n  // 安装炮台底座\r\n  installCannoBase = (data, options) => {\r\n    const info = data[this.baseName]\r\n    this.drawCannoBase(info)\r\n    this.imgInfo[this.baseName] = info\r\n  }\r\n  // 绘制底座\r\n  drawCannoBase = (info) => {\r\n    const { w, h, img, W, H } = info\r\n    // 绘制到底部中心\r\n    const x = (W - w) / 2, y = H - h + 2\r\n    ctx.drawImage(img, x, y, w, h)\r\n  }\r\n\r\n  // 安装炮台\r\n  installCanno = (data, type) => {\r\n    const key = `${this.cannoNamePrefix}${type}.${this.cannoNameEndFix}`\r\n    const info = data[key]\r\n    this.drawCanno(info)\r\n    this.imgInfo[key] = info\r\n    this.positionInfo.type = type\r\n  }\r\n  // 绘制炮台\r\n  drawCanno = (info) => {\r\n    /*\r\n        计算弧度:\r\n          1. 我们知道炮台中心点位置 a\r\n          2. 我们知道鼠标移动位置 b\r\n          3. 炮台是垂直于canvas的\r\n          4. 弧度 === tan(对边 / 临边)\r\n    */\r\n    const { w, h, img, W, H, handlesInfo: { mousemove } } = info\r\n    const canvas = ctx.canvas\r\n    const offsetLeft = canvas.offsetLeft\r\n    const offsetTop = canvas.offsetTop\r\n    const x = (W - w) / 2 + 43, y = H - h / 4 + 20\r\n    const a = x + offsetLeft - mousemove.x + w / 2\r\n    const b = y + offsetTop - mousemove.y\r\n    const arc = Math.atan2(b, a) - Math.PI / 2\r\n    ctx.save()\r\n    ctx.translate(x + w / 2, y + h / 10)\r\n    ctx.rotate(arc)\r\n    ctx.drawImage(\r\n      img,\r\n      0, h / 5 * this.frame, w, h / 5,\r\n      -w / 2, -(h / 10), w, h / 5\r\n    )\r\n    ctx.restore()\r\n    this.positionInfo = {\r\n      ...this.positionInfo,\r\n      x: x + w / 2,\r\n      y: y + h / 10,\r\n      arc\r\n    }\r\n  }\r\n\r\n  // 安装炮弹/发射炮弹\r\n  installBullte = (data, type) => {\r\n    // 安装炮弹\r\n    Bullte.installBullte(data, type, this.bulltes)\r\n    // 发射炮弹\r\n    Bullte.launchBullte(this.bulltes)\r\n  }\r\n\r\n  // 添加炮弹\r\n  addBullte = () => {\r\n    this.bulltes.push(this.positionInfo)\r\n  }\r\n\r\n  // 控制炮台发送炮弹动画\r\n  setFrame = () => {\r\n    window.requestAnimationFrame(this.transition)\r\n  }\r\n  transition = () => {\r\n    this.frame++\r\n    if (this.frame >= 5) {\r\n      this.frame = 0\r\n      return\r\n    }\r\n    window.requestAnimationFrame(this.setFrame)\r\n  }\r\n}\r\nexport default new Cannocontroller","/**\r\n * 工具函数\r\n */\r\nexport const createInstance = (instance, options = {}) => {\r\n  return new instance(options)\r\n}\r\nexport const deg2Arc = (deg) => {\r\n  return deg * (Math.PI / 180)\r\n}\r\nexport const arc2Deg = (arc) => {\r\n  return arc * (180 / Math.PI)\r\n}\r\nexport function registerListener (eventName, el, cb) {\r\n  let handles = {\r\n    mousemove: {},\r\n    click: {}\r\n  }\r\n  el.addEventListener(eventName, (e) => {\r\n    handles[eventName] = {\r\n      x: e.clientX,\r\n      y: e.clientY\r\n    }\r\n    cb && cb(e)\r\n  })\r\n  return handles\r\n}\r\n\r\n","import { cannoInstance } from '../controller/index'\r\nimport { createInstance, registerListener } from '../utils'\r\nimport { ctx } from '../index'\r\nimport bullet from '../controller/bullet'\r\n\r\n// 炮台类\r\nclass Canno {\r\n  constructor(data, options = {}) {\r\n    this.data = data\r\n    // 炮台有分颜色 1-7\r\n    this.type = options.type || 1\r\n    this.addBullte()\r\n    // 安装\r\n    this.install()\r\n  }\r\n  // 安装炮台底座\r\n  installCannoBase = () => {\r\n    cannoInstance.installCannoBase(this.data, this.type)\r\n  }\r\n  // 安装炮台\r\n  installCanno = () => {\r\n    cannoInstance.installCanno(this.data, this.type)\r\n  }\r\n  // 安装炮弹\r\n  installBullte = () => {\r\n    cannoInstance.installBullte(this.data, this.type)\r\n  }\r\n  // 添加炮弹\r\n  addBullte = () => {\r\n    registerListener('click', ctx.canvas, () => {\r\n      cannoInstance.addBullte()\r\n      cannoInstance.setFrame()\r\n    })\r\n  }\r\n  install = () => {\r\n    window.requestAnimationFrame(this.draw)\r\n  }\r\n  draw = () => {\r\n    const canvas = ctx.canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n    // 绘制顺序，后面会覆盖前面\r\n    this.installCannoBase()\r\n    this.installBullte()\r\n    this.installCanno()\r\n    window.requestAnimationFrame(this.install)\r\n  }\r\n}\r\nexport default Canno","import Canno from './canno'\r\nexport function initAllInstance () {\r\n  return {\r\n    Canno,\r\n  }\r\n}","/**\r\n * 入口\r\n */\r\nimport { initRequestData } from './api'\r\nimport { initAllInstance } from './instance/index'\r\nimport { createInstance, registerListener } from './utils'\r\nexport let ctx\r\nasync function init () {\r\n  // 初始化canvas\r\n  const { ctx: _ctx, W, H, handlesInfo } = initCanvas('fishing')\r\n  // 初始化数据\r\n  const data = await initRequestData({ ctx: _ctx, W, H, handlesInfo })\r\n  ctx = _ctx\r\n  // 初始化类\r\n  const { Canno } = initAllInstance()\r\n  // 创建炮台实例\r\n  createInstance(Canno, data)\r\n}\r\ninit()\r\n\r\nfunction initCanvas (id) {\r\n  const canvas = document.getElementById(id)\r\n  const ctx = canvas.getContext('2d')\r\n  // 注册事件\r\n  const handlesInfo = registerListener('mousemove', canvas)\r\n  return {\r\n    ctx,\r\n    W: canvas.width,\r\n    H: canvas.height,\r\n    handlesInfo\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":["res","bottomJson","bulletJson","webJson","initRequestData","ctx","_ctx","W","H","handlesInfo","count","total","reduce","p","frames","Object","keys","length","Promise","resolve","result","c","forEach","key","frame","x","y","img","Image","src","onload","w","width","h","height","loadResolve","Bulltecontroller","constructor","baseName","endType","speed","installBullte","data","type","bulltes","info","bullte","drawBullte","arc","save","translate","rotate","drawImage","restore","launchBullte","bullet","Math","sin","cos","Cannocontroller","cannoNamePrefix","cannoNameEndFix","imgInfo","positionInfo","installCannoBase","options","drawCannoBase","installCanno","drawCanno","mousemove","canvas","offsetLeft","offsetTop","a","b","atan2","PI","Bullte","addBullte","push","setFrame","window","requestAnimationFrame","transition","createInstance","instance","registerListener","eventName","el","cb","handles","click","addEventListener","e","clientX","clientY","Canno","install","cannoInstance","draw","clearRect","initAllInstance","init","initCanvas","id","document","getElementById","getContext"],"mappings":"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"}
>>>>>>> 652c38b29ccb3ec4e778d400cad96402c51c6059
