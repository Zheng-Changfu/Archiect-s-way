{"version":3,"file":"vue.js","sources":["../lib/utils.js","../lib/observe/array.js","../lib/observe/index.js","../lib/state.js","../lib/vDom/patch.js","../lib/lifecycle.js","../lib/compile/parser.js","../lib/compile/generate.js","../lib/compile/index.js","../lib/init.js","../lib/vDom/index.js","../lib/render.js","../lib/index.js"],"sourcesContent":["export const isFunction = val => {\n  return typeof val === 'function'\n}\nexport const isObject = val => {\n  return typeof val === 'object' && val !== null\n}\nexport const isArray = val => {\n  return Array.isArray(val)\n}\n\nexport let compileTemplate = {\n  // 匹配标签名\n  tag: `[a-zA-Z][0-9a-zA-Z]*`,\n  // 匹配标签开始\n  startTag: html => {\n    const reg = new RegExp(`^<(${compileTemplate.tag})`)\n    return html.match(reg)\n  },\n  // 匹配标签属性\n  tagAttributes: text => {\n    // 标签属性有3种,a=b a='b' a=\"b\",前后可能有多个空格\n    const reg = /\\s*([^=\\s'\"\\/<>]+)\\s*=\\s*(?:\"([^\"]+)\")|(?:'([^']+)')|([^\\s\"'=<>`]+)?/\n    return text.match(reg)\n  },\n  // 匹配标签结束\n  tagClose: text => {\n    // 可能为自结束标签，可以为> ,/>\n    const reg = /^\\s*(\\/?)>/\n    return text.match(reg)\n  },\n  // 匹配结束标签\n  closeTag: text => {\n    // </div >\n    const reg = new RegExp(`^<\\/(${compileTemplate.tag})*>`)\n    return text.match(reg)\n  },\n  // 匹配插值语法\n  qn: (text, count = 1) => {\n    const reg = /\\{\\{([\\s\\S]*?)\\}\\}/g\n    return count ? text.match(reg) : reg\n  }\n}","const oldArrayProto = Array.prototype\nexport const arrayMethods = Object.create(oldArrayProto)\nlet methods = [\n  'shift',\n  'unshift',\n  'sort',\n  'pop',\n  'splice',\n  'push',\n  'reverse'\n]\n\nmethods.forEach(method => {\n  // 对数组方法进行重写\n  arrayMethods[method] = function (...args) {\n    oldArrayProto[method].call(this, ...args)\n    let ob = this.__ob__ // 拿到Observe实例\n\n    // 如果方法是新增属性的，那么我们要对新增的属性再次进行响应式处理\n    let inserted\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break;\n      case 'splice':\n        inserted = args.slice(2)\n        break;\n      default:\n        break;\n    }\n\n    if (inserted) {\n      // 说明调用了push/unshift/splice等方法\n      // 将新增的数据定义成响应式\n      ob.observeArray(inserted)\n    }\n  }\n})\n","import { isArray, isObject } from \"../utils\"\nimport { arrayMethods } from './array'\nclass Observe {\n  constructor(data) {\n\n    // 响应式属性里都会有一个__ob__属性\n    // data.__ob__ = this // 这么写会导致爆栈，因为一直在调用walk方法，然后一直在循环调用new Observe\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false // 不可被枚举(遍历)\n    })\n    // 如果数据为一个数组，那么也会进来，此时我们要改写数组中的方法\n    if (isArray(data)) {\n      // 改写数组的方法\n      data.__proto__ = arrayMethods\n      this.observeArray(data) // 对数组中是对象的定义成响应式\n    } else {\n      this.walk(data)\n    }\n  }\n  observeArray (data) {\n    data.forEach(item => {\n      observe(item)\n    })\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      const value = data[key]\n      defineReactive(data, key, value)\n    })\n  }\n}\n\nfunction defineReactive (data, key, value) {\n  // 如果对象嵌套对象，继续进行递归观测\n  observe(value)\n  Object.defineProperty(data, key, {\n    get () {\n      return value\n    },\n    set (newVal) {\n      // 如果用户新赋值一个对象，那么新对象也要进行观测\n      observe(newVal)\n      value = newVal\n    }\n  })\n}\n\nexport function observe (data) {\n  if (!isObject(data)) return\n  if (data.__ob__) return\n  return new Observe(data)\n}","import { observe } from './observe/index'\nimport { isFunction } from './utils'\nexport function initState (vm) {\n  initData(vm)\n  // 挂载\n  if (vm.$options.el) {\n    vm.$mount(vm)\n  }\n}\n\nfunction proxy (vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[source][key]\n    },\n    set (newVal) {\n      vm[source][key] = newVal\n    }\n  })\n}\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = vm._data = isFunction(data) ? data.call(vm) : data\n  // 所有的数据现在都在_data中，那么我们做一层数据代理，外界访问vm.xxx的时候我们去vm._data中读取xxx\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\n","export function patch (oldVnode, vNode) {\n  // 新旧虚拟dom比较,暂时不做\n  const parent = oldVnode.parentNode\n  if (parent.nodeType === 1) {\n    // 真实元素\n    const elm = createEl(vNode)\n    parent.insertBefore(elm, oldVnode.nextSibling)\n    parent.removeChild(oldVnode)\n  } else {\n\n  }\n}\n\nfunction createEl (vNode) {\n  const { vm, text, key, children, tag, data } = vNode\n  console.log(vNode, '~~')\n  let elm = ''\n  if (tag) {\n    // 标签\n    elm = document.createElement(tag)\n    console.log(elm, 'elm')\n    if (children && children.length) {\n      for (let i = 0; i < children.length; i++) {\n        const item = children[i]\n        elm.appendChild(createEl(item))\n      }\n    }\n  } else {\n    // 文本\n    elm = document.createTextNode(text)\n  }\n  return elm\n}","import { patch } from './vDom/patch'\nexport function mountComponent (vm, el) {\n  // 生成虚拟dom\n  const vNode = vm._render()\n  // 更新\n  // vm._update(vNode)\n  vm._update(vNode)\n}\nexport function lifecycleMixin (Vue) {\n  Vue.prototype._update = function (vNode) {\n    const vm = this\n    patch(vm.$el, vNode)\n  }\n}","import { compileTemplate } from '../utils'\n\n// 树根\nlet root = null\n// 栈\nconst stack = []\n// 创建ast语法树\nfunction createAstElement (tag, attrs) {\n  return {\n    tag,\n    parent: null,\n    children: [],\n    attrs,\n    type: 1,\n    text: ''\n  }\n}\nfunction start (tag, attributes) {\n  // console.log('标签开始', tag, attributes)\n  // 取出栈中最后一个\n  const parent = stack[stack.length - 1]\n  // 创建ast元素\n  const element = createAstElement(tag, attributes)\n  // 如果没有根元素，那么创建出来的ast元素就是根元素\n  if (!root) {\n    root = element\n  }\n  if (parent) {\n    // 有父级元素\n    parent.children.push(element)\n    element.parent = parent\n  }\n  stack.push(element)\n}\nfunction chars (text) {\n  // console.log('标签文本', text)\n  const parent = stack[stack.length - 1]\n  text = text.replace(/\\s/g, '')\n  if (text) {\n    parent.children.push({\n      type: 3,\n      text\n    })\n  }\n}\nfunction end (tag) {\n  // console.log('标签结束', tag)\n  const element = stack.pop()\n  if (element.tag !== tag) {\n    throw new Error('标签有误')\n  }\n}\nexport function parserHtml (html) {\n  /**\n   * 用正则匹配标签开始，标签名，然后提取标签名放入容器中，然后移除掉匹配的部分 \n   * 用正则匹配标签属性，然后提取属性放入容器中，然后移除掉匹配的部分\n   * 用正则匹配标签结束，然后移除掉匹配的部分\n   * 用正则匹配标签中的文本，然后提取文本放入容器中，然后移除掉匹配的部分\n   * 用正则匹配标签结束，然后提取标签结束名和标签开始的标签名进行匹配，如果相同，说明标签相同，不相同，抛错\n   */\n  function advance (len) {\n    html = html.substring(len)\n  }\n  // 解析开始标签\n  function parseStartTag () {\n    let startTag = compileTemplate.startTag(html)\n    if (startTag) {\n      advance(startTag[0].length)\n      let match = {\n        tag: startTag[1],\n        attrs: []\n      }\n      let text, end\n      // 匹配属性,只要没有到结束标签并且一直都可以匹配到属性，就一直循环\n      while (!(end = compileTemplate.tagClose(html)) && (text = compileTemplate.tagAttributes(html))) {\n        match.attrs.push({\n          key: text[1],\n          value: text[2] || text[3] || text[4]\n        })\n        advance(text[0].length)\n      }\n      if (end) {\n        advance(end[0].length)\n      }\n      return match\n    }\n    return false\n  }\n  // 解析结束标签\n  function parseEndTag () {\n    let endTag = compileTemplate.closeTag(html)\n    if (endTag) {\n      advance(endTag[0].length)\n      return endTag[1]\n    }\n    return false\n  }\n  while (html) {\n    let index = html.indexOf('<')\n    if (index === 0) {\n      // 不是标签开始位置就是标签结束位置\n      // 解析开始标签\n      let startMatch = parseStartTag()\n      if (startMatch) {\n        start(startMatch.tag, startMatch.attrs)\n        continue\n      }\n      let endMatch = parseEndTag()\n      if (endMatch) {\n        end(endMatch)\n        continue\n      }\n    }\n    // 拿到文本的所有内容\n    let text = html.slice(0, index)\n    if (text) {\n      chars(text)\n      advance(text.length)\n    }\n  }\n  return root\n}","import { compileTemplate } from '../utils'\nfunction gen (c) {\n  if (c.type === 1) {\n    // 元素\n    return generate(c)\n  } else {\n    // 文本 _v('hello')\n    const text = c.text\n    const regRes = compileTemplate.qn(text)\n    // 如果没有匹配到插值语法 hello {{name}} world  ==> 'hello' + name + 'world'\n    if (!regRes) {\n      return `_v('${text}')`\n    } else {\n      const reg = compileTemplate.qn(text, 0)\n      let tokens = []\n      let lastIndex = 0\n      text.replace(reg, function (...args) {\n        if (text.slice(lastIndex, args[2])) {\n          tokens.push(JSON.stringify(text.slice(lastIndex, args[2])))\n        }\n        if (lastIndex < text.length - 1) {\n          tokens.push(args[1].trim())\n        }\n        lastIndex = args[2] + (args[0].length)\n      })\n      if (lastIndex < text.length) {\n        if (text.slice(lastIndex)) {\n          tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n      }\n      return `_v(${tokens.join('+')})`\n    }\n  }\n}\nfunction genChildren (root) {\n  const children = root.children\n  if (children && children.length) {\n    const res = children.map(c => gen(c)).join('+')\n    return res\n  }\n  return false\n}\nfunction genProps (props) {\n  let str = ''\n  for (let i = 0; i < props.length; i++) {\n    let { key, value } = props[i]\n    if (key === 'style') {\n      let styleObj = {}\n      // \"color: red;background-color: #fff\"; 转成对象\n      value.replace(/([^:;]+):([^:;]+)/g, function (p, s1, s2) {\n        styleObj[s1] = s2\n      })\n      value = styleObj\n    }\n    str += `${key}:${JSON.stringify(value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}\nexport function generate (root) {\n  // 将ast语法树拼接成字符串\n  /**\n   * _c('div',{id:'root',name:'zhengchangfu'},'hello')\n   * new Function + with语法\n   */\n  const children = genChildren(root)\n  let code = `_c('${root.tag}',${root.attrs.length ? genProps(root.attrs) : 'undefined'}${children ? `,${children}` : ''})`\n  //code ==>  _c('div',{id:\"root\",name:\"zhengchangfu\",style:{\"color\":\" red\",\"background-color\":\" #fff\"}},_c('p',undefined,_c('span',undefined,_v(\"我叫\"+name+\"哈哈\"))))\n  return code\n} ","import { parserHtml } from './parser'\nimport { generate } from './generate'\nexport function CompileToFunction (html) {\n  // 将html编译成ast语法树\n  let root = parserHtml(html)\n\n  // 将ast语法树转换成代码\n  let code = generate(root)\n  console.log(code, 'code')\n  // 将code代码串转成函数\n  let render = new Function(`with(this){return ${code}}`)\n  // console.log(render, 'render')\n  /**\n   * ƒ anonymous(){\n      with(this){\n        return _c(\n          'div',\n          {\n            id:\"root\",\n            name:\"zhengchangfu\",\n            style:{\n              \"color\":\" red\",\n              \"background-color\":\" #fff\"\n            }\n          },\n          _c(\n            'p',\n            undefined,\n            _c(\n              'span',\n              undefined,\n              _v(\n                \"我叫\"+name+\"哈哈\"\n                )\n              )\n            )\n          )\n       }\n    }\n   */\n  return render\n}\n","import { initState } from './state'\nimport { mountComponent } from './lifecycle'\nimport { CompileToFunction } from './compile/index'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n    initState(vm)\n  }\n  Vue.prototype.$mount = function (vm) {\n    let el = vm.$options.el\n    if (!vm.$options.render) {\n      el = document.querySelector(el)\n      vm.$el = el\n      el = el.outerHTML\n      // 将字符串编译成函数\n      let render = CompileToFunction(el)\n      console.log(render, 'render')\n      vm.$options.render = render\n    }\n    // 挂载组件\n    mountComponent(vm, el)\n  }\n}","\nexport function createElement (vm, tag, data = {}, ...children) {\n  return createVDom(vm, tag, data, data.key, children, undefined)\n}\nexport function createText (vm, text) {\n  return createVDom(vm, undefined, undefined, undefined, undefined, text)\n}\nfunction createVDom (vm, tag, data, key, children, text) {\n  return {\n    vm,\n    tag,\n    data,\n    key,\n    children,\n    text\n  }\n}","\nimport { createElement, createText } from './vDom/index'\nexport function renderMixin (Vue) {\n  // 创建元素\n  Vue.prototype._c = function (...args) {\n    return createElement(this, ...args)\n  }\n  // 创建文本\n  Vue.prototype._v = function (text) {\n    return createText(this, text)\n  }\n  Vue.prototype._render = function () {\n    const vm = this\n    const render = vm.$options.render\n    let vNode = render.call(vm)\n    console.log(vNode)\n    return vNode\n  }\n}","import { initMixin } from './init'\nimport { renderMixin } from './render'\nimport { lifecycleMixin } from './lifecycle'\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\nexport default Vue"],"names":["isFunction","val","isObject","isArray","Array","compileTemplate","tag","startTag","html","reg","RegExp","match","tagAttributes","text","tagClose","closeTag","qn","count","oldArrayProto","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","ob","__ob__","inserted","slice","observeArray","Observe","data","defineProperty","value","enumerable","__proto__","walk","item","observe","keys","key","defineReactive","get","set","newVal","initState","vm","initData","$options","el","$mount","proxy","source","_data","patch","oldVnode","vNode","parent","parentNode","nodeType","elm","createEl","insertBefore","nextSibling","removeChild","children","console","log","document","createElement","length","i","appendChild","createTextNode","mountComponent","_render","_update","lifecycleMixin","Vue","$el","root","stack","createAstElement","attrs","type","start","attributes","element","push","chars","replace","end","pop","Error","parserHtml","advance","len","substring","parseStartTag","parseEndTag","endTag","index","indexOf","startMatch","endMatch","gen","c","generate","regRes","tokens","lastIndex","JSON","stringify","trim","join","genChildren","res","map","genProps","props","str","styleObj","p","s1","s2","code","CompileToFunction","render","Function","initMixin","_init","options","querySelector","outerHTML","createVDom","undefined","createText","renderMixin","_c","_v"],"mappings":"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"}