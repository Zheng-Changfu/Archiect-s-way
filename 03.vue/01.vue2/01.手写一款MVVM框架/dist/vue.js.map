{"version":3,"file":"vue.js","sources":["../lib/utils.js","../lib/observe/index.js","../lib/state.js","../lib/init.js","../lib/index.js"],"sourcesContent":["// 工具函数汇总\n\n// 检测数据类型\nexport const typeofFn = (fnName) => {\n  // 生成函数\n  return (data) => {\n    return Object.prototype.toString.call(data).slice(8, -1) === fnName.slice(2)\n  }\n}\n\n\n","import { typeofFn } from \"../utils\"\n// 劫持函数\nconst observe = (data) => {\n  // 如果data是一个对象，才劫持\n  if (!(typeofFn('isObject')(data))) {\n    return\n  }\n  // 定义响应式\n  return new Observe(data)\n}\n\n// 观察者\nclass Observe {\n  constructor(data) {\n    this.walk(data)\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      const value = data[key]\n      defineReactive(data, key, value)\n    })\n  }\n}\n// 定义响应式函数\nconst defineReactive = (data, key, value) => {\n  // 如果value还是一个对象，需要递归处理\n  if (typeofFn('isObject')(value)) {\n    observe(value)\n  }\n  Object.defineProperty(data, key, {\n    get () {\n      return value\n    },\n    set (newVal) {\n      // 如果用户在外面手动对data中的数据进行赋值并且要是一个对象，要对赋值后的数据再次进行劫持\n      observe(newVal)\n      value = newVal\n    }\n  })\n}\n\nexport default observe","// 状态初始化\nimport { typeofFn } from './utils'\nimport observe from './observe/index'\nexport const _initState = (vm) => {\n  let options = vm.$options\n  if (options.data) {\n    initData(vm)\n  }\n\n  if (options.computed) {\n\n  }\n\n  if (options.watch) {\n\n  }\n}\nconst initData = (vm) => {\n  let data = vm.$options.data\n  // 判断data是一个函数还是一个对象,data中的this指向实例\n  // 通过vm._data 将响应式属性和vm进行关联\n  data = vm._data = typeofFn('isFunction')(data) ? data.call(vm) : data\n  // 观测对象(劫持)\n  observe(data)\n}","// Vue原型上的扩展方法的工厂函数模块\nimport { _initState } from './state'\nexport const initMixin = (Vue) => {\n  Vue.prototype._init = function (ops) {\n    const vm = this\n    vm.$options = ops\n    if (vm.$options.data) {\n      // 初始化状态\n      _initState(vm)\n    }\n  }\n}\n","// Vue的入口\n\nimport { initMixin } from './init'\nfunction Vue (ops) {\n  // 用户传入的配置项\n  this._init(ops)\n}\n// Vue原型的方法我们使用注入的方式来进行扩展\ninitMixin(Vue)\nexport default Vue"],"names":["typeofFn","fnName","data","Object","prototype","toString","call","slice","observe","Observe","walk","keys","forEach","key","value","defineReactive","defineProperty","get","set","newVal","_initState","vm","options","$options","initData","computed","watch","_data","initMixin","Vue","_init","ops"],"mappings":"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"}